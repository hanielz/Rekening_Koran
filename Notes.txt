
data = {'Response' : 
        {
        "statusCode": 200,
        "errorCode": "000",
        "responseCode": "00",
        "responseMessage": "Success",
        "errors": "null"
        ,"Data" : 
                {
                    "Header": 
                        {
                            "Nama"              : "Haniel Zefanya",
                            "Alamat"            : "null",
                            "NomorRekening"     : "null",
                                        "NamaProduk"        : "null",
                                        "Valuta"            : "null",
                            "TanggalLaporan"    : "null",					
                            "PeriodeTransaksi"  : "null",
                            "UnitKerja"         : "null",
                            "AlamatUnitKerja"   : "null"
                        }
                    ,"Body" :
                        { 
                        'NoRek'              :  row[field_map['TRACCT']] 
                        ,'tanggalTransaksi'  :  row[field_map['TRDATE']] 
                        ,'tanggalEfektif'    :  row[field_map['TRDATE']] 
                        ,'jamTransaksi' 	 :  row[field_map['TRTIME'] ] 
                        ,'kodeTransaksi' 	 :  row[field_map['TRNCD'] ]
                        ,'deskTran'  	     :  ''
                        ,'saldoAwal'         :  ''
                        ,'mutasiKredit'      :  row[field_map['Kredit']] 
                        ,'mytasiDebit'       :  row[field_map['Debit']] 
                        ,'saldoAkhr'         :  ''
                        }
                } #closing of Data
        }  #closing of response     
} #closing of data


    SELECT GELAR_SEBELUM_NAMA ,NAMA_LENGKAP,GELAR_SESUDAH_NAMA,
    ALAMAT_ID1, ALAMAT_ID2,ALAMAT_ID3,ALAMAT_ID4,
    current_date() AS TanggalLaporan,
    JABATAN AS Pekerjaan,
    ALAMAT_KANTOR3, RT_KANTOR, RW_KANTOR, KELURAHAN_KANTOR,KECAMATAN_KANTOR, KOTA_KANTOR, PROPINSI_KANTOR, KODEPOS_KANTOR
    FROM CHUB_DEMOGRAPHY 
    WHERE CIFNO = 'MC86345'

#VARIABLE / JSON
SELECT 
PRODUCT AS NamaProduk,
CURRENCY AS Valuta
FROM CHUB_SAVING WHERE CIFNO  = 'MC86345' AND ACCTNO LIKE '%10001000002535'


#mutasi query
ELECT 
                        dhist.TRANCD 	
                        ,dhist.TRACCT
                        ,dhist.TRDATE 
                        ,CASE 
                            WHEN dhist.TRDORC ='C' THEN dhist.amt
                            ELSE 0
                        END AS Kredit
                        ,CASE	
                            WHEN dhist.TRDORC ='D' THEN dhist.amt 
                            ELSE 0
                        END AS Debit
                        ,dhist.TRUSER 
                        ,dhist.TRREMK 
                        ,dhist.TRTIME
                        ,dhist.TRANCD
                        ,dhist.TLBDS1
                        ,dhist.TLBDS2	
                        FROM REKENING_KORAN.DL_DDHIST dhist
                    where TRACCT='{acctno}' and TO_NUMBER(TRDATE) BETWEEN {start_date} AND {end_date}


##demografi query 
SELECT 
	                 GELAR_SEBELUM_NAMA 
                     ,NAMA_LENGKAP
                     ,GELAR_SESUDAH_NAMA
                     ,ALAMAT_ID1
                     ,ALAMAT_ID2
                     ,ALAMAT_ID3
                     ,ALAMAT_ID4
                     ,current_date() AS TanggalLaporan
                     ,JABATAN AS Pekerjaan
                     ,ALAMAT_KANTOR3, RT_KANTOR
                     ,RW_KANTOR, KELURAHAN_KANTOR
                     ,KECAMATAN_KANTOR
                     ,KOTA_KANTOR
                     ,PROPINSI_KANTOR
                     ,KODEPOS_KANTOR
                    FROM CHUB_DEMOGRAPHY 
                       WHERE cifno IN 
                        (SELECT b.CIFNO FROM REKENING_KORAN.DDMAST b
                       WHERE b.ACCTNO ='{acctno}')



##QUERY JOIN DARI ARIS ##
SELECT 
c.GELAR_SEBELUM_NAMA ,c.NAMA_LENGKAP,c.GELAR_SESUDAH_NAMA,
c.ALAMAT_ID1, c.ALAMAT_ID2,c.ALAMAT_ID3,c.ALAMAT_ID4,
current_date() AS TanggalLaporan,
c.JABATAN AS Pekerjaan,
c.ALAMAT_KANTOR3, c.RT_KANTOR, c.RW_KANTOR, c.KELURAHAN_KANTOR,c.KECAMATAN_KANTOR, c.KOTA_KANTOR, c.PROPINSI_KANTOR, c.KODEPOS_KANTOR,
d.PRODUCT,
d.CURRENCY
FROM  CHUB_DEMOGRAPHY c 
JOIN 
(SELECT 
	a.CIFNO,a.ACCTNO,a.PRODUCT,a.CURRENCY
FROM CHUB_SAVING a
WHERE a.CIFNO IN 
(SELECT b.CIFNO FROM REKENING_KORAN.DDMAST b
WHERE  b.ACCTNO ='115101000126539')
AND a.ACCTNO like '%115101000126539' ) AS d
ON c.CIFNO = d.CIFNO